MODULE CPG_SL1_TYPE_MOD

USE FIELD_MODULE
USE FIELD_FACTORY_MODULE
USE FIELD_REGISTRY_MOD
USE PARKIND1, ONLY : JPRB, JPIM, JPIB
USE YOM_YGFL, ONLY : TYPE_GFL_COMP

IMPLICIT NONE




ABSTRACT INTERFACE 
  LOGICAL FUNCTION FUN_GREP (YDCOMP, YDMODEL)
    USE YOM_YGFL, ONLY : TYPE_GFL_COMP
    USE TYPE_MODEL, ONLY : MODEL
    TYPE (TYPE_GFL_COMP), INTENT (IN) :: YDCOMP
    TYPE (MODEL),  INTENT (IN) :: YDMODEL
  END FUNCTION
END INTERFACE

PRIVATE :: FUN_GREP



PRIVATE :: GREPVARSB

TYPE CPG_SL1B_2D_TYPE
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: P (:) => NULL ()
  CLASS (FIELD_2RB), POINTER :: F_P => NULL ()

  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: P_F (:) => NULL ()
  CLASS (FIELD_2RB), POINTER :: F_P_F => NULL ()

  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: P_SPF (:) => NULL ()
  CLASS (FIELD_2RB), POINTER :: F_P_SPF => NULL ()

  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: P_SP (:) => NULL ()
  CLASS (FIELD_2RB), POINTER :: F_P_SP => NULL ()

  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: P_P (:) => NULL ()
  CLASS (FIELD_2RB), POINTER :: F_P_P => NULL ()

END TYPE

TYPE CPG_SL1B_3D_TYPE
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: P (:,:) => NULL ()
  CLASS (FIELD_3RB), POINTER :: F_P => NULL ()

  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: P_F (:,:) => NULL ()
  CLASS (FIELD_3RB), POINTER :: F_P_F => NULL ()

  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: P_SPF (:,:) => NULL ()
  CLASS (FIELD_3RB), POINTER :: F_P_SPF => NULL ()

  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: P_SP (:,:) => NULL ()
  CLASS (FIELD_3RB), POINTER :: F_P_SP => NULL ()

  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: P_P (:,:) => NULL ()
  CLASS (FIELD_3RB), POINTER :: F_P_P => NULL ()

  TYPE (TYPE_GFL_COMP) :: YCOMP
END TYPE

TYPE CPG_SL1B_TYPE
  LOGICAL :: LOWNED = .FALSE.
  INTEGER (KIND=JPIM) :: NLEV = -1
  INTEGER (KIND=JPIB) :: ISIZE = 0
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ZVIEW (:,:) => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ZDATA (:,:,:) => NULL ()
  CLASS (FIELD_3RB), POINTER :: F_DATA => NULL ()
  TYPE (CPG_SL1B_3D_TYPE) :: U9
  TYPE (CPG_SL1B_3D_TYPE) :: V9
  TYPE (CPG_SL1B_3D_TYPE) :: T9
  TYPE (CPG_SL1B_3D_TYPE) :: PD9
  TYPE (CPG_SL1B_3D_TYPE) :: VD9
  TYPE (CPG_SL1B_3D_TYPE) :: NHX9
  TYPE (CPG_SL1B_3D_TYPE) :: UR0
  TYPE (CPG_SL1B_3D_TYPE) :: VR0
  TYPE (CPG_SL1B_3D_TYPE) :: ZR0
  TYPE (CPG_SL1B_3D_TYPE) :: WR0
  TYPE (CPG_SL1B_3D_TYPE) :: UR00
  TYPE (CPG_SL1B_3D_TYPE) :: VR00
  TYPE (CPG_SL1B_3D_TYPE) :: ZR00
  TYPE (CPG_SL1B_3D_TYPE) :: WR00
  TYPE (CPG_SL1B_3D_TYPE) :: WRA
  TYPE (CPG_SL1B_3D_TYPE) :: UR9
  TYPE (CPG_SL1B_3D_TYPE) :: VR9
  TYPE (CPG_SL1B_3D_TYPE) :: DBBC9
  TYPE (CPG_SL1B_3D_TYPE) :: DPHI9
  TYPE (CPG_SL1B_2D_TYPE) :: GWS9
  TYPE (CPG_SL1B_3D_TYPE) :: U0
  TYPE (CPG_SL1B_3D_TYPE) :: V0
  TYPE (CPG_SL1B_3D_TYPE) :: T0
  TYPE (CPG_SL1B_3D_TYPE) :: PD0
  TYPE (CPG_SL1B_3D_TYPE) :: VD0
  TYPE (CPG_SL1B_3D_TYPE) :: C9
  TYPE (CPG_SL1B_2D_TYPE) :: SP9
  TYPE (CPG_SL1B_2D_TYPE) :: SP0
  TYPE (CPG_SL1B_3D_TYPE) :: C0
  TYPE (CPG_SL1B_3D_TYPE) :: UP9
  TYPE (CPG_SL1B_3D_TYPE) :: VP9
  TYPE (CPG_SL1B_3D_TYPE) :: TP9
  TYPE (CPG_SL1B_3D_TYPE) :: U9_SI
  TYPE (CPG_SL1B_3D_TYPE) :: V9_SI
  TYPE (CPG_SL1B_3D_TYPE) :: T9_SI
  TYPE (CPG_SL1B_3D_TYPE) :: PD9_SI
  TYPE (CPG_SL1B_3D_TYPE) :: VD9_SI
  TYPE (CPG_SL1B_3D_TYPE) :: C9_SI
  TYPE (CPG_SL1B_3D_TYPE) :: UF9
  TYPE (CPG_SL1B_3D_TYPE) :: VF9
  TYPE (CPG_SL1B_3D_TYPE) :: TF9
  TYPE (CPG_SL1B_3D_TYPE) :: VDF9
  TYPE (CPG_SL1B_3D_TYPE) :: U9_NL
  TYPE (CPG_SL1B_3D_TYPE) :: V9_NL
  TYPE (CPG_SL1B_3D_TYPE) :: T9_NL
  TYPE (CPG_SL1B_3D_TYPE) :: PD9_NL
  TYPE (CPG_SL1B_3D_TYPE) :: VD9_NL
  TYPE (CPG_SL1B_3D_TYPE) :: C9_NL
  TYPE (CPG_SL1B_3D_TYPE) :: ZR9
  TYPE (CPG_SL1B_3D_TYPE) :: Z9
  TYPE (CPG_SL1B_3D_TYPE) :: Z0
  TYPE (CPG_SL1B_3D_TYPE) :: ZP9

  TYPE (CPG_SL1B_3D_TYPE) :: Q
  TYPE (CPG_SL1B_3D_TYPE) :: I
  TYPE (CPG_SL1B_3D_TYPE) :: L
  TYPE (CPG_SL1B_3D_TYPE) :: IMF
  TYPE (CPG_SL1B_3D_TYPE) :: LMF
  TYPE (CPG_SL1B_3D_TYPE) :: LCONV
  TYPE (CPG_SL1B_3D_TYPE) :: ICONV
  TYPE (CPG_SL1B_3D_TYPE) :: RCONV
  TYPE (CPG_SL1B_3D_TYPE) :: SCONV
  TYPE (CPG_SL1B_3D_TYPE) :: IRAD
  TYPE (CPG_SL1B_3D_TYPE) :: LRAD
  TYPE (CPG_SL1B_3D_TYPE) :: S
  TYPE (CPG_SL1B_3D_TYPE) :: R
  TYPE (CPG_SL1B_3D_TYPE) :: G
  TYPE (CPG_SL1B_3D_TYPE) :: H
  TYPE (CPG_SL1B_3D_TYPE) :: TKE
  TYPE (CPG_SL1B_3D_TYPE) :: TTE
  TYPE (CPG_SL1B_3D_TYPE) :: EFB1
  TYPE (CPG_SL1B_3D_TYPE) :: EFB2
  TYPE (CPG_SL1B_3D_TYPE) :: EFB3
  TYPE (CPG_SL1B_3D_TYPE) :: A
  TYPE (CPG_SL1B_3D_TYPE) :: AMF
  TYPE (CPG_SL1B_3D_TYPE) :: O3
  TYPE (CPG_SL1B_3D_TYPE) :: SRC
  TYPE (CPG_SL1B_3D_TYPE) :: MXL
  TYPE (CPG_SL1B_3D_TYPE) :: SHTUR
  TYPE (CPG_SL1B_3D_TYPE) :: FQTUR
  TYPE (CPG_SL1B_3D_TYPE) :: FSTUR
  TYPE (CPG_SL1B_3D_TYPE) :: CPF
  TYPE (CPG_SL1B_3D_TYPE) :: SPF
  TYPE (CPG_SL1B_3D_TYPE) :: CVGQ
  TYPE (CPG_SL1B_3D_TYPE) :: QVA
  TYPE (CPG_SL1B_3D_TYPE), ALLOCATABLE :: GHG (:)
  TYPE (CPG_SL1B_3D_TYPE), ALLOCATABLE :: CHEM (:)
  TYPE (CPG_SL1B_3D_TYPE), ALLOCATABLE :: AERO (:)
  TYPE (CPG_SL1B_3D_TYPE) :: LRCH4
  TYPE (CPG_SL1B_3D_TYPE), ALLOCATABLE :: FORC (:)
  TYPE (CPG_SL1B_3D_TYPE), ALLOCATABLE :: EZDIAG (:)
  TYPE (CPG_SL1B_3D_TYPE), ALLOCATABLE :: ERA40 (:)
  TYPE (CPG_SL1B_3D_TYPE), ALLOCATABLE :: NOGW (:)
  TYPE (CPG_SL1B_3D_TYPE), ALLOCATABLE :: EMIS3D (:)
  TYPE (CPG_SL1B_3D_TYPE), ALLOCATABLE :: EDRP (:)
  TYPE (CPG_SL1B_3D_TYPE), ALLOCATABLE :: SLDIA (:)
  TYPE (CPG_SL1B_3D_TYPE), ALLOCATABLE :: AERAOT (:)
  TYPE (CPG_SL1B_3D_TYPE), ALLOCATABLE :: AERLISI (:)
  TYPE (CPG_SL1B_3D_TYPE), ALLOCATABLE :: AEROUT (:)
  TYPE (CPG_SL1B_3D_TYPE), ALLOCATABLE :: AEROCLIM (:)
  TYPE (CPG_SL1B_3D_TYPE), ALLOCATABLE :: UVP (:)
  TYPE (CPG_SL1B_3D_TYPE) :: PHYCTY
  TYPE (CPG_SL1B_3D_TYPE) :: RSPEC
  TYPE (CPG_SL1B_3D_TYPE) :: SDSAT
  TYPE (CPG_SL1B_3D_TYPE) :: CVV
  TYPE (CPG_SL1B_3D_TYPE) :: RKTH
  TYPE (CPG_SL1B_3D_TYPE) :: RKTQV
  TYPE (CPG_SL1B_3D_TYPE) :: RKTQC
  TYPE (CPG_SL1B_3D_TYPE) :: UOM
  TYPE (CPG_SL1B_3D_TYPE) :: UAL
  TYPE (CPG_SL1B_3D_TYPE) :: DOM
  TYPE (CPG_SL1B_3D_TYPE) :: DAL
  TYPE (CPG_SL1B_3D_TYPE) :: UEN
  TYPE (CPG_SL1B_3D_TYPE) :: UNEBH
  TYPE (CPG_SL1B_3D_TYPE), ALLOCATABLE :: LIMA (:)
  TYPE (CPG_SL1B_3D_TYPE) :: FSD
  TYPE (CPG_SL1B_3D_TYPE), ALLOCATABLE :: EXT (:)

  TYPE (CPG_SL1B_3D_TYPE), ALLOCATABLE :: GFL (:)
CONTAINS
  PROCEDURE :: INIT => CPG_SL1B_TYPE_INIT
  PROCEDURE :: FINAL => CPG_SL1B_TYPE_FINAL
  PROCEDURE :: SYNC_HOST => CPG_SL1B_TYPE_SYNC_HOST

  PROCEDURE :: UPDATE_VIEW => CPG_SL1B_TYPE_UPDATE_VIEW


  PROCEDURE :: ZERO => CPG_SL1B_TYPE_ZERO
  PROCEDURE :: ZERO_HOST_PARALLEL => CPG_SL1B_TYPE_ZERO_HOST_PARALLEL
  PROCEDURE :: ZERO_DEVICE_PARALLEL => CPG_SL1B_TYPE_ZERO_DEVICE_PARALLEL

  PROCEDURE :: SHUFFLE => CPG_SL1B_TYPE_SHUFFLE
  PROCEDURE :: SHUFFLE_HOST_PARALLEL => CPG_SL1B_TYPE_SHUFFLE_HOST_PARALLEL
  PROCEDURE :: SHUFFLE_DEVICE_PARALLEL => CPG_SL1B_TYPE_SHUFFLE_DEVICE_PARALLEL


END TYPE CPG_SL1B_TYPE


PRIVATE :: GREPVARSF

TYPE CPG_SL1F_2D_TYPE
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: P (:) => NULL ()
  CLASS (FIELD_1RB), POINTER :: F_P => NULL ()

  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: P_F (:) => NULL ()
  CLASS (FIELD_1RB), POINTER :: F_P_F => NULL ()

  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: P_SPF (:) => NULL ()
  CLASS (FIELD_1RB), POINTER :: F_P_SPF => NULL ()

  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: P_SP (:) => NULL ()
  CLASS (FIELD_1RB), POINTER :: F_P_SP => NULL ()

  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: P_P (:) => NULL ()
  CLASS (FIELD_1RB), POINTER :: F_P_P => NULL ()

END TYPE

TYPE CPG_SL1F_3D_TYPE
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: P (:,:) => NULL ()
  CLASS (FIELD_2RB), POINTER :: F_P => NULL ()

  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: P_F (:,:) => NULL ()
  CLASS (FIELD_2RB), POINTER :: F_P_F => NULL ()

  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: P_SPF (:,:) => NULL ()
  CLASS (FIELD_2RB), POINTER :: F_P_SPF => NULL ()

  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: P_SP (:,:) => NULL ()
  CLASS (FIELD_2RB), POINTER :: F_P_SP => NULL ()

  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: P_P (:,:) => NULL ()
  CLASS (FIELD_2RB), POINTER :: F_P_P => NULL ()

  TYPE (TYPE_GFL_COMP) :: YCOMP
END TYPE

TYPE CPG_SL1F_TYPE
  LOGICAL :: LOWNED = .FALSE.
  INTEGER (KIND=JPIM) :: NLEV = -1
  INTEGER (KIND=JPIB) :: ISIZE = 0
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ZDATA (:,:) => NULL ()
  CLASS (FIELD_2RB), POINTER :: F_DATA => NULL ()
  TYPE (CPG_SL1F_3D_TYPE) :: U9
  TYPE (CPG_SL1F_3D_TYPE) :: V9
  TYPE (CPG_SL1F_3D_TYPE) :: T9
  TYPE (CPG_SL1F_3D_TYPE) :: PD9
  TYPE (CPG_SL1F_3D_TYPE) :: VD9
  TYPE (CPG_SL1F_3D_TYPE) :: NHX9
  TYPE (CPG_SL1F_3D_TYPE) :: UR0
  TYPE (CPG_SL1F_3D_TYPE) :: VR0
  TYPE (CPG_SL1F_3D_TYPE) :: ZR0
  TYPE (CPG_SL1F_3D_TYPE) :: WR0
  TYPE (CPG_SL1F_3D_TYPE) :: UR00
  TYPE (CPG_SL1F_3D_TYPE) :: VR00
  TYPE (CPG_SL1F_3D_TYPE) :: ZR00
  TYPE (CPG_SL1F_3D_TYPE) :: WR00
  TYPE (CPG_SL1F_3D_TYPE) :: WRA
  TYPE (CPG_SL1F_3D_TYPE) :: UR9
  TYPE (CPG_SL1F_3D_TYPE) :: VR9
  TYPE (CPG_SL1F_3D_TYPE) :: DBBC9
  TYPE (CPG_SL1F_3D_TYPE) :: DPHI9
  TYPE (CPG_SL1F_2D_TYPE) :: GWS9
  TYPE (CPG_SL1F_3D_TYPE) :: U0
  TYPE (CPG_SL1F_3D_TYPE) :: V0
  TYPE (CPG_SL1F_3D_TYPE) :: T0
  TYPE (CPG_SL1F_3D_TYPE) :: PD0
  TYPE (CPG_SL1F_3D_TYPE) :: VD0
  TYPE (CPG_SL1F_3D_TYPE) :: C9
  TYPE (CPG_SL1F_2D_TYPE) :: SP9
  TYPE (CPG_SL1F_2D_TYPE) :: SP0
  TYPE (CPG_SL1F_3D_TYPE) :: C0
  TYPE (CPG_SL1F_3D_TYPE) :: UP9
  TYPE (CPG_SL1F_3D_TYPE) :: VP9
  TYPE (CPG_SL1F_3D_TYPE) :: TP9
  TYPE (CPG_SL1F_3D_TYPE) :: U9_SI
  TYPE (CPG_SL1F_3D_TYPE) :: V9_SI
  TYPE (CPG_SL1F_3D_TYPE) :: T9_SI
  TYPE (CPG_SL1F_3D_TYPE) :: PD9_SI
  TYPE (CPG_SL1F_3D_TYPE) :: VD9_SI
  TYPE (CPG_SL1F_3D_TYPE) :: C9_SI
  TYPE (CPG_SL1F_3D_TYPE) :: UF9
  TYPE (CPG_SL1F_3D_TYPE) :: VF9
  TYPE (CPG_SL1F_3D_TYPE) :: TF9
  TYPE (CPG_SL1F_3D_TYPE) :: VDF9
  TYPE (CPG_SL1F_3D_TYPE) :: U9_NL
  TYPE (CPG_SL1F_3D_TYPE) :: V9_NL
  TYPE (CPG_SL1F_3D_TYPE) :: T9_NL
  TYPE (CPG_SL1F_3D_TYPE) :: PD9_NL
  TYPE (CPG_SL1F_3D_TYPE) :: VD9_NL
  TYPE (CPG_SL1F_3D_TYPE) :: C9_NL
  TYPE (CPG_SL1F_3D_TYPE) :: ZR9
  TYPE (CPG_SL1F_3D_TYPE) :: Z9
  TYPE (CPG_SL1F_3D_TYPE) :: Z0
  TYPE (CPG_SL1F_3D_TYPE) :: ZP9

  TYPE (CPG_SL1F_3D_TYPE) :: Q
  TYPE (CPG_SL1F_3D_TYPE) :: I
  TYPE (CPG_SL1F_3D_TYPE) :: L
  TYPE (CPG_SL1F_3D_TYPE) :: IMF
  TYPE (CPG_SL1F_3D_TYPE) :: LMF
  TYPE (CPG_SL1F_3D_TYPE) :: LCONV
  TYPE (CPG_SL1F_3D_TYPE) :: ICONV
  TYPE (CPG_SL1F_3D_TYPE) :: RCONV
  TYPE (CPG_SL1F_3D_TYPE) :: SCONV
  TYPE (CPG_SL1F_3D_TYPE) :: IRAD
  TYPE (CPG_SL1F_3D_TYPE) :: LRAD
  TYPE (CPG_SL1F_3D_TYPE) :: S
  TYPE (CPG_SL1F_3D_TYPE) :: R
  TYPE (CPG_SL1F_3D_TYPE) :: G
  TYPE (CPG_SL1F_3D_TYPE) :: H
  TYPE (CPG_SL1F_3D_TYPE) :: TKE
  TYPE (CPG_SL1F_3D_TYPE) :: TTE
  TYPE (CPG_SL1F_3D_TYPE) :: EFB1
  TYPE (CPG_SL1F_3D_TYPE) :: EFB2
  TYPE (CPG_SL1F_3D_TYPE) :: EFB3
  TYPE (CPG_SL1F_3D_TYPE) :: A
  TYPE (CPG_SL1F_3D_TYPE) :: AMF
  TYPE (CPG_SL1F_3D_TYPE) :: O3
  TYPE (CPG_SL1F_3D_TYPE) :: SRC
  TYPE (CPG_SL1F_3D_TYPE) :: MXL
  TYPE (CPG_SL1F_3D_TYPE) :: SHTUR
  TYPE (CPG_SL1F_3D_TYPE) :: FQTUR
  TYPE (CPG_SL1F_3D_TYPE) :: FSTUR
  TYPE (CPG_SL1F_3D_TYPE) :: CPF
  TYPE (CPG_SL1F_3D_TYPE) :: SPF
  TYPE (CPG_SL1F_3D_TYPE) :: CVGQ
  TYPE (CPG_SL1F_3D_TYPE) :: QVA
  TYPE (CPG_SL1F_3D_TYPE), ALLOCATABLE :: GHG (:)
  TYPE (CPG_SL1F_3D_TYPE), ALLOCATABLE :: CHEM (:)
  TYPE (CPG_SL1F_3D_TYPE), ALLOCATABLE :: AERO (:)
  TYPE (CPG_SL1F_3D_TYPE) :: LRCH4
  TYPE (CPG_SL1F_3D_TYPE), ALLOCATABLE :: FORC (:)
  TYPE (CPG_SL1F_3D_TYPE), ALLOCATABLE :: EZDIAG (:)
  TYPE (CPG_SL1F_3D_TYPE), ALLOCATABLE :: ERA40 (:)
  TYPE (CPG_SL1F_3D_TYPE), ALLOCATABLE :: NOGW (:)
  TYPE (CPG_SL1F_3D_TYPE), ALLOCATABLE :: EMIS3D (:)
  TYPE (CPG_SL1F_3D_TYPE), ALLOCATABLE :: EDRP (:)
  TYPE (CPG_SL1F_3D_TYPE), ALLOCATABLE :: SLDIA (:)
  TYPE (CPG_SL1F_3D_TYPE), ALLOCATABLE :: AERAOT (:)
  TYPE (CPG_SL1F_3D_TYPE), ALLOCATABLE :: AERLISI (:)
  TYPE (CPG_SL1F_3D_TYPE), ALLOCATABLE :: AEROUT (:)
  TYPE (CPG_SL1F_3D_TYPE), ALLOCATABLE :: AEROCLIM (:)
  TYPE (CPG_SL1F_3D_TYPE), ALLOCATABLE :: UVP (:)
  TYPE (CPG_SL1F_3D_TYPE) :: PHYCTY
  TYPE (CPG_SL1F_3D_TYPE) :: RSPEC
  TYPE (CPG_SL1F_3D_TYPE) :: SDSAT
  TYPE (CPG_SL1F_3D_TYPE) :: CVV
  TYPE (CPG_SL1F_3D_TYPE) :: RKTH
  TYPE (CPG_SL1F_3D_TYPE) :: RKTQV
  TYPE (CPG_SL1F_3D_TYPE) :: RKTQC
  TYPE (CPG_SL1F_3D_TYPE) :: UOM
  TYPE (CPG_SL1F_3D_TYPE) :: UAL
  TYPE (CPG_SL1F_3D_TYPE) :: DOM
  TYPE (CPG_SL1F_3D_TYPE) :: DAL
  TYPE (CPG_SL1F_3D_TYPE) :: UEN
  TYPE (CPG_SL1F_3D_TYPE) :: UNEBH
  TYPE (CPG_SL1F_3D_TYPE), ALLOCATABLE :: LIMA (:)
  TYPE (CPG_SL1F_3D_TYPE) :: FSD
  TYPE (CPG_SL1F_3D_TYPE), ALLOCATABLE :: EXT (:)

  TYPE (CPG_SL1F_3D_TYPE), ALLOCATABLE :: GFL (:)
CONTAINS
  PROCEDURE :: INIT => CPG_SL1F_TYPE_INIT
  PROCEDURE :: FINAL => CPG_SL1F_TYPE_FINAL
  PROCEDURE :: SYNC_HOST => CPG_SL1F_TYPE_SYNC_HOST

  PROCEDURE, PRIVATE :: SET_POINTERS => CPG_SL1F_TYPE_SET_POINTERS


END TYPE CPG_SL1F_TYPE


REAL(KIND=JPRB), PRIVATE, SAVE, TARGET :: ZDUM1 (1), ZDUM2 (1, 1)

CONTAINS



SUBROUTINE GREPVARSB (YDCPG_SL1B, YDMODEL, COND, YDVARS_LIST)
USE TYPE_MODEL, ONLY : MODEL
TYPE(CPG_SL1B_TYPE), INTENT(INOUT) :: YDCPG_SL1B
TYPE(MODEL), INTENT(IN) :: YDMODEL
PROCEDURE (FUN_GREP) :: COND
TYPE (CPG_SL1B_3D_TYPE), ALLOCATABLE :: YDVARS_LIST (:)




































































































































END SUBROUTINE

SUBROUTINE CPG_SL1B_TYPE_INIT (SELF, REGISTRY, NLEV, YDTPTRSLB1 &
& , YDMODEL &
& , YGFL &
& , PERSISTENT &
& , PB1 &
& , KBLKMIN &
& , KBLKMAX &
& )
USE PTRSLB1, ONLY : TPTRSLB1
USE YOM_YGFL  , ONLY : TYPE_GFLD
USE TYPE_MODEL, ONLY : MODEL
USE EINT_MOD  , ONLY : SL_STRUCT
CLASS (CPG_SL1B_TYPE)                        :: SELF
TYPE (FIELD_REGISTRY),              INTENT (IN)    :: REGISTRY
INTEGER (KIND=JPIM),                INTENT (IN)    :: NLEV
TYPE (TPTRSLB1),                    INTENT (IN)    :: YDTPTRSLB1
TYPE (TYPE_GFLD),                   INTENT (IN)    :: YGFL
TYPE (MODEL),               TARGET, INTENT (IN)    :: YDMODEL
LOGICAL, OPTIONAL,                  INTENT (IN)    :: PERSISTENT
REAL (KIND=JPRB), OPTIONAL, TARGET, INTENT (IN)    :: PB1 (:,:,:)
INTEGER (KIND=JPIM), OPTIONAL,      INTENT (IN)    :: KBLKMIN, KBLKMAX









































































































































END SUBROUTINE CPG_SL1B_TYPE_INIT

SUBROUTINE CPG_SL1B_TYPE_FINAL (SELF)
CLASS (CPG_SL1B_TYPE)          :: SELF





































































































































































































































END SUBROUTINE CPG_SL1B_TYPE_FINAL

SUBROUTINE CPG_SL1B_TYPE_SYNC_HOST (YDCPG_SL1B)
USE YOMHOOK, ONLY : LHOOK, DR_HOOK, JPHOOK
CLASS (CPG_SL1B_TYPE) :: YDCPG_SL1B




























































END SUBROUTINE CPG_SL1B_TYPE_SYNC_HOST

SUBROUTINE CPG_SL1B_TYPE_UPDATE_VIEW (SELF, BLOCK_INDEX)
CLASS (CPG_SL1B_TYPE)     :: SELF
INTEGER(KIND=JPIM), INTENT (IN) :: BLOCK_INDEX







END SUBROUTINE CPG_SL1B_TYPE_UPDATE_VIEW


SUBROUTINE GREPVARSF (YDCPG_SL1F, YDMODEL, COND, YDVARS_LIST)
USE TYPE_MODEL, ONLY : MODEL
TYPE(CPG_SL1F_TYPE), INTENT(INOUT) :: YDCPG_SL1F
TYPE(MODEL), INTENT(IN) :: YDMODEL
PROCEDURE (FUN_GREP) :: COND
TYPE (CPG_SL1F_3D_TYPE), ALLOCATABLE :: YDVARS_LIST (:)




































































































































END SUBROUTINE

SUBROUTINE CPG_SL1F_TYPE_INIT (SELF, REGISTRY, NLEV, YDTPTRSLB1 &
& , YDMODEL &
& , YGFL &
& , YDSL &
& , PB1 &
& )
USE PTRSLB1, ONLY : TPTRSLB1
USE YOM_YGFL  , ONLY : TYPE_GFLD
USE TYPE_MODEL, ONLY : MODEL
USE EINT_MOD  , ONLY : SL_STRUCT
CLASS (CPG_SL1F_TYPE)                        :: SELF
TYPE (FIELD_REGISTRY),              INTENT (IN)    :: REGISTRY
INTEGER (KIND=JPIM),                INTENT (IN)    :: NLEV
TYPE (TPTRSLB1),                    INTENT (IN)    :: YDTPTRSLB1
TYPE (TYPE_GFLD),                   INTENT (IN)    :: YGFL
TYPE (MODEL),               TARGET, INTENT (IN)    :: YDMODEL
TYPE(SL_STRUCT),  OPTIONAL, TARGET, INTENT (IN)    :: YDSL
REAL (KIND=JPRB), OPTIONAL, TARGET, INTENT (IN)    :: PB1 (:,:)






































































































































END SUBROUTINE CPG_SL1F_TYPE_INIT

SUBROUTINE CPG_SL1F_TYPE_FINAL (SELF)
CLASS (CPG_SL1F_TYPE)          :: SELF




































































































































































































































END SUBROUTINE CPG_SL1F_TYPE_FINAL

SUBROUTINE CPG_SL1F_TYPE_SYNC_HOST (YDCPG_SL1F)
USE YOMHOOK, ONLY : LHOOK, DR_HOOK, JPHOOK
CLASS (CPG_SL1F_TYPE) :: YDCPG_SL1F




























































END SUBROUTINE CPG_SL1F_TYPE_SYNC_HOST

SUBROUTINE CPG_SL1F_TYPE_SET_POINTERS (SELF)
USE FIELD_ACCESS_MODULE
CLASS (CPG_SL1F_TYPE)     :: SELF







END SUBROUTINE CPG_SL1F_TYPE_SET_POINTERS


SUBROUTINE CPG_SL1B_TYPE_ZERO (YDCPG_SL1B, YDCPG_OPTS, YDCPG_BNDS)
USE YOMHOOK, ONLY : LHOOK, DR_HOOK, JPHOOK
USE CPG_OPTS_TYPE_MOD  , ONLY : CPG_OPTS_TYPE, CPG_BNDS_TYPE
CLASS (CPG_SL1B_TYPE) :: YDCPG_SL1B
TYPE(CPG_OPTS_TYPE) ,INTENT(IN)   :: YDCPG_OPTS
TYPE(CPG_BNDS_TYPE) ,INTENT(IN)   :: YDCPG_BNDS





END SUBROUTINE

SUBROUTINE CPG_SL1B_TYPE_ZERO_HOST_PARALLEL (YDCPG_SL1B, YDCPG_OPTS, YDCPG_BNDS)
USE YOMHOOK, ONLY : LHOOK, DR_HOOK, JPHOOK
USE CPG_OPTS_TYPE_MOD  , ONLY : CPG_OPTS_TYPE, CPG_BNDS_TYPE
CLASS (CPG_SL1B_TYPE) :: YDCPG_SL1B
TYPE(CPG_OPTS_TYPE) ,INTENT(IN)   :: YDCPG_OPTS
TYPE(CPG_BNDS_TYPE) ,INTENT(IN)   :: YDCPG_BNDS








END SUBROUTINE

SUBROUTINE CPG_SL1B_TYPE_ZERO_DEVICE_PARALLEL (YDCPG_SL1B, YDCPG_OPTS, YDCPG_BNDS)
USE YOMHOOK, ONLY : LHOOK, DR_HOOK, JPHOOK
USE CPG_OPTS_TYPE_MOD  , ONLY : CPG_OPTS_TYPE, CPG_BNDS_TYPE
CLASS (CPG_SL1B_TYPE) :: YDCPG_SL1B
TYPE(CPG_OPTS_TYPE) ,INTENT(IN)   :: YDCPG_OPTS
TYPE(CPG_BNDS_TYPE) ,INTENT(IN)   :: YDCPG_BNDS




























































END SUBROUTINE

SUBROUTINE CPG_SL1B_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B, YDSL, YDCPG_OPTS, YDCPG_BNDS, YDCPG_SL1F)
USE YOMHOOK, ONLY : LHOOK, DR_HOOK, JPHOOK
USE CPG_OPTS_TYPE_MOD  , ONLY : CPG_OPTS_TYPE, CPG_BNDS_TYPE
USE EINT_MOD           , ONLY : SL_STRUCT
CLASS (CPG_SL1B_TYPE)             :: YDCPG_SL1B
TYPE(SL_STRUCT)     ,INTENT(IN)   :: YDSL
TYPE(CPG_OPTS_TYPE) ,INTENT(IN)   :: YDCPG_OPTS
TYPE(CPG_BNDS_TYPE) ,INTENT(IN)   :: YDCPG_BNDS
CLASS (CPG_SL1F_TYPE)             :: YDCPG_SL1F






























































END SUBROUTINE

SUBROUTINE CPG_SL1B_TYPE_SHUFFLE_HOST_PARALLEL (YDCPG_SL1B, YDSL, YDCPG_OPTS, YDCPG_BNDS, YDCPG_SL1F)
USE YOMHOOK, ONLY : LHOOK, DR_HOOK, JPHOOK
USE CPG_OPTS_TYPE_MOD  , ONLY : CPG_OPTS_TYPE, CPG_BNDS_TYPE
USE EINT_MOD           , ONLY : SL_STRUCT
CLASS (CPG_SL1B_TYPE)             :: YDCPG_SL1B
TYPE(SL_STRUCT)     ,INTENT(IN)   :: YDSL
TYPE(CPG_OPTS_TYPE) ,INTENT(IN)   :: YDCPG_OPTS
TYPE(CPG_BNDS_TYPE) ,INTENT(IN)   :: YDCPG_BNDS
CLASS (CPG_SL1F_TYPE)             :: YDCPG_SL1F











END SUBROUTINE

SUBROUTINE CPG_SL1B_TYPE_SHUFFLE (YDCPG_SL1B, YDSL, YDCPG_OPTS, YDCPG_BNDS, YDCPG_SL1F)
USE YOMHOOK, ONLY : LHOOK, DR_HOOK, JPHOOK
USE CPG_OPTS_TYPE_MOD  , ONLY : CPG_OPTS_TYPE, CPG_BNDS_TYPE
USE EINT_MOD           , ONLY : SL_STRUCT
CLASS (CPG_SL1B_TYPE)             :: YDCPG_SL1B
TYPE(SL_STRUCT)     ,INTENT(IN)   :: YDSL
TYPE(CPG_OPTS_TYPE) ,INTENT(IN)   :: YDCPG_OPTS
TYPE(CPG_BNDS_TYPE) ,INTENT(IN)   :: YDCPG_BNDS
CLASS (CPG_SL1F_TYPE)             :: YDCPG_SL1F




END SUBROUTINE

SUBROUTINE CPG_SL1B_TYPE_SHUFFLE_PB1 (PB1B, YDSL, YDCPG_OPTS, YDCPG_BNDS, PB1F)
USE YOMHOOK, ONLY : LHOOK, DR_HOOK, JPHOOK
USE CPG_OPTS_TYPE_MOD  , ONLY : CPG_OPTS_TYPE, CPG_BNDS_TYPE
USE EINT_MOD           , ONLY : SL_STRUCT
REAL (KIND=JPRB)    ,INTENT(IN)    :: PB1B (:,:)
TYPE(SL_STRUCT)     ,INTENT(IN)    :: YDSL
TYPE(CPG_OPTS_TYPE) ,INTENT(IN)    :: YDCPG_OPTS
TYPE(CPG_BNDS_TYPE) ,INTENT(IN)    :: YDCPG_BNDS
REAL (KIND=JPRB)    ,INTENT(INOUT) :: PB1F (:,:)
#ifdef __INTEL_COMPILER

#else

#endif




#ifdef __INTEL_COMPILER



#endif



END SUBROUTINE

END MODULE CPG_SL1_TYPE_MOD

