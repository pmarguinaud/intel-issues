MODULE YOECUMF2

USE PARKIND1  ,ONLY : JPIM     ,JPRB

IMPLICIT NONE

SAVE

!     ----------------------------------------------------------------------
!*    ** *YOECUMF2* - PARAMETERS FOR NEW LINEARIZED CUMULUS MASS-FLUX SCHEME
!     ----------------------------------------------------------------------

TYPE :: TECUMF2
REAL(KIND=JPRB) :: ENTRORG2
REAL(KIND=JPRB) :: DETRPEN2
REAL(KIND=JPRB) :: ENTSHALP2
REAL(KIND=JPRB) :: ENTSTPC12
REAL(KIND=JPRB) :: ENTSTPC22
!LLL
REAL(KIND=JPRB) :: ENTSTPC32
!LLL
REAL(KIND=JPRB) :: ENTRDD2
REAL(KIND=JPRB) :: RMFCMIN2
REAL(KIND=JPRB) :: RMFDEPS2
REAL(KIND=JPRB) :: RDEPTHS2
REAL(KIND=JPRB) :: RPRCON2
REAL(KIND=JPRB) :: RTAU2
REAL(KIND=JPRB) :: RCPECONS2
REAL(KIND=JPRB) :: RCUCOV2
REAL(KIND=JPRB) :: RTAUMEL2
REAL(KIND=JPRB) :: RUVPER2
REAL(KIND=JPRB) :: RMFSOLCT2
REAL(KIND=JPRB) :: RMFSOLTQ2
REAL(KIND=JPRB) :: RMFSOLUV2
REAL(KIND=JPRB) :: RMFSOLRHS2
REAL(KIND=JPRB) :: RMFCFL2
REAL(KIND=JPRB) :: RMFLIA2
REAL(KIND=JPRB) :: RCAPDCYCL2
REAL(KIND=JPRB) :: RTAU02

LOGICAL :: LMFMID2
LOGICAL :: LMFDD2
LOGICAL :: LMFDUDV2
LOGICAL :: LMFUVDIS2
LOGICAL :: LMFWETB2
LOGICAL :: LMFGLAC2

!LLL INTEGER(KIND=JPIM) :: NJKT12, NJKT22, NJKT32
INTEGER(KIND=JPIM) :: NJKT12, NJKT22, NJKT32, NJKT52, NJKT62

!----------------------------------------------------------------------------
CONTAINS
  PROCEDURE, PASS :: PRINT => PRINT_CONFIGURATION 
END TYPE TECUMF2
!============================================================================

!! TYPE(TECUMF2), POINTER :: YRECUMF2 => NULL()

!*    ** *YOECUMF2* - PARAMETERS FOR NEW LINEARIZED CUMULUS MASS-FLUX SCHEME

!     P.LOPEZ                       E. C. M. W. F.      21/8/2006
!     Inspired from M.TIEDTKE       E. C. M. W. F.      18/1/89

!     NAME      TYPE      PURPOSE
!     ----      ----      -------

!     LMFMID2    LOGICAL  TRUE IF MIDLEVEL    CONVECTION IS SWITCHED ON
!     LMFDD2     LOGICAL  TRUE IF CUMULUS DOWNDRAFT      IS SWITCHED ON
!     LMFDUDV2   LOGICAL  TRUE IF CUMULUS FRICTION       IS SWITCHED ON
!     LMFUVDIS2  LOGICAL  TRUE IF KIN.ENERGY DISSIPATION BY CUMULUS FRICTION IS SWITCHED ON
!     LMFWETB2   LOGICAL  TRUE IF WET BULB TEMPERATURE USED IN SNOW MELTING
!     LMFGLAC2   LOGICAL  TRUE IF RAIN GLACIATION CONTRIBUTION INCLUDED
!     DETRPEN2   REAL     DETRAINMENT RATE FOR PENETRATIVE CONVECTION
!     ENTSHALP2  REAL     SCALING FACTOR FOR SHALLOW CONVECTION ENTRAINMENT RATE
!     ENTRORG2   REAL     COEFFICIENT FOR ORGANIZED ENTRAINMENT DEEP CONVECTION
!     ENTSTPC12  REAL     SHALLOW ENTRAINMENT TEST PARCEL ENTRAINMENTcst 1
!     ENTSTPC22  REAL     SHALLOW ENTRAINMENT TEST PARCEL ENTRAINMENTcst 2
!LLL
!     ENTSTPC32  REAL     ENTRAINMENT SCALING FOR PBL HEIGHT COMPUTATION
!LLL
!     ENTRDD2    REAL     ENTRAINMENT RATE FOR CUMULUS DOWNDRAFTS
!     RMFCMIN2   REAL     MINIMUM MASSFLUX VALUE (FOR SAFETY)
!     RMFDEPS2   REAL     FRACTIONAL MASSFLUX FOR DOWNDRAFTS AT LFS
!     RDEPTHS2   REAL     MAXIMUM ALLOWED CLOUD THICKNESS FOR SHALLOW
!     RPRCON2    REAL     COEFFICIENTS FOR DETERMINING CONVERSION
!                         FROM CLOUD WATER TO RAIN
!     RCPECONS2  REAL     COEFFICIENT FOR RAIN EVAPORATION BELOW CLOUD
!     RCUCOV2    REAL     CONVECTIVE CLOUD COVER FOR RAIN EVPORATION
!     RTAUMEL2   REAL     TIME CONSTANT FOR MELTING
!     RTAU2      REAL     ADJUSTMENT TIME SCALE IN CAPE CLOSURE
!     RMFCFL2    REAL     MULTIPLE OF CFL STABILITY CRITERIUM 
!     RMFLIA2    REAL     VALUE OF ABSOLUTE MASS FLUX LIMIT
!     RMFSOLCT2  REAL     SOLVER FOR MASSFLUX ADVECTION EQUATION FOR TRACERS
!                         0 : EXPLICIT,  0-1 : SEMI-IMPLICIT, >=1 : FULLY IMPLICIT.
!     RMFSOLUV2  REAL     SOLVER FOR MASSFLUX ADVECTION EQUATION FOR MOMENTUM
!     RMFSOLTQ2  REAL     SOLVER FOR MASSFLUX ADVECTION EQUATION FOR T AND Q
!     RMFSOLRHS2 REAL     SOLVER FOR MODEL TENDENCY IN RHS OF IMPLICIT SOLVER
!     RUVPER2    REAL     UPDRAIGHT VELOCITY PERTURBATION AT KLEV FOR IMPLICIT

!LLL!     NJKT12, NJKT22, NJKT32  INTEGER LEVEL LIMITS FOR CUBASEN2, CUDDRAFN2
!     NJKT12, NJKT22, NJKT32, NJKT52, NJKT62  INTEGER LEVEL LIMITS FOR CUBASEN2, CUDDRAFN2, VDFHGHTNS
!     ---------------------------------------------------------------------

CONTAINS

SUBROUTINE PRINT_CONFIGURATION(SELF, KDEPTH, KOUTNO)
  IMPLICIT NONE
  CLASS(TECUMF2), INTENT(IN) :: SELF
  INTEGER       , INTENT(IN) :: KDEPTH
  INTEGER       , INTENT(IN) :: KOUTNO

  INTEGER :: IDEPTHLOC

  IDEPTHLOC = KDEPTH+2

  WRITE(KOUTNO,*) REPEAT(' ',KDEPTH   ) // 'model%yrml_phy_slin%yrephli : '
  WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'ENTRORG2 = ', SELF%ENTRORG2
  WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'DETRPEN2 = ', SELF%DETRPEN2
  WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'ENTSHALP2 = ', SELF%ENTSHALP2
  WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'ENTSTPC12 = ', SELF%ENTSTPC12
  WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'ENTSTPC22 = ', SELF%ENTSTPC22
!LLL
  WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'ENTSTPC32 = ', SELF%ENTSTPC32
!LLL
  WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'ENTRDD2 = ', SELF%ENTRDD2
  WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RMFCMIN2 = ', SELF%RMFCMIN2
  WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RMFDEPS2 = ', SELF%RMFDEPS2
  WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RDEPTHS2 = ', SELF%RDEPTHS2
  WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RPRCON2 = ', SELF%RPRCON2
  WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RTAU2 = ', SELF%RTAU2
  WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RCPECONS2 = ', SELF%RCPECONS2
  WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RCUCOV2 = ', SELF%RCUCOV2
  WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RTAUMEL2 = ', SELF%RTAUMEL2
  WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RUVPER2 = ', SELF%RUVPER2
  WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RMFSOLCT2 = ', SELF%RMFSOLCT2
  WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RMFSOLTQ2 = ', SELF%RMFSOLTQ2
  WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RMFSOLUV2 = ', SELF%RMFSOLUV2
  WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RMFSOLRHS2 = ', SELF%RMFSOLRHS2
  WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RMFCFL2 = ', SELF%RMFCFL2
  WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RMFLIA2 = ', SELF%RMFLIA2
  WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RCAPDCYCL2 = ', SELF%RCAPDCYCL2
  WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RTAU02 = ', SELF%RTAU02
  WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'LMFMID2 = ', SELF%LMFMID2
  WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'LMFDD2 = ', SELF%LMFDD2
  WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'LMFDUDV2 = ', SELF%LMFDUDV2
  WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'LMFUVDIS2 = ', SELF%LMFUVDIS2
  WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'LMFWETB2 = ', SELF%LMFWETB2
  WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'LMFGLAC2 = ', SELF%LMFGLAC2

END SUBROUTINE PRINT_CONFIGURATION

END MODULE YOECUMF2
