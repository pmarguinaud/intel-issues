MODULE YOEAERD

USE PARKIND1  ,ONLY : JPRB

IMPLICIT NONE

SAVE

!     ------------------------------------------------------------------
!*     *YOEAERD* SPECTRAL DISTRIBUTION OF AEROSOLS
!     ------------------------------------------------------------------

TYPE :: TEAERD
REAL(KIND=JPRB),ALLOCATABLE:: CVDAES(:)
REAL(KIND=JPRB),ALLOCATABLE:: CVDAEL(:)
REAL(KIND=JPRB),ALLOCATABLE:: CVDAEU(:)
REAL(KIND=JPRB),ALLOCATABLE:: CVDAED(:)

REAL(KIND=JPRB) :: RAESC(66)
REAL(KIND=JPRB) :: RAESS(55)
REAL(KIND=JPRB) :: RAELC(66)
REAL(KIND=JPRB) :: RAELS(55)
REAL(KIND=JPRB) :: RAEUC(66)
REAL(KIND=JPRB) :: RAEUS(55)
REAL(KIND=JPRB) :: RAEDC(66)
REAL(KIND=JPRB) :: RAEDS(55)

REAL(KIND=JPRB) :: RCAEOPS
REAL(KIND=JPRB) :: RCAEOPL
REAL(KIND=JPRB) :: RCAEOPU
REAL(KIND=JPRB) :: RCAEOPD
REAL(KIND=JPRB) :: RCTRBGA
REAL(KIND=JPRB) :: RCVOBGA
REAL(KIND=JPRB) :: RCSTBGA
REAL(KIND=JPRB) :: RCTRPT
REAL(KIND=JPRB) :: RCAEADK(3)
REAL(KIND=JPRB) :: RCAEADM
REAL(KIND=JPRB) :: RCAEROS
!----------------------------------------------------------------------------
CONTAINS
  PROCEDURE, PASS :: PRINT => PRINT_CONFIGURATION 
END TYPE TEAERD
!============================================================================

!!TYPE(TEAERD), POINTER :: YREAERD => NULL()


!*     *YOEAERD* SPECTRAL DISTRIBUTION OF AEROSOLS.
!                     (TRIANGULAR *T10* TRUNCATION FOR AEROSOLS).

!     R.G AND M.J        E.C.M.W.F.     29/11/82.
!     J.-J. MORCRETTE    E.C.M.W.F.     92/09/24  Adaptation to IFS

!      NAME     TYPE      PURPOSE
!      ----     ----      -------

!     *CAES_*   REAL      *REFERS TO *SEA AEROSOLS.
!     *CAEL_*   REAL      *REFERS TO *LAND AEROSOLS.
!     *CAEU_*   REAL      *REFERS TO *URBAN AEROSOLS.
!     *CAED_*   REAL      *REFERS TO *DESERT AEROSOLS.
!     *C___C*   REAL      *REFERS TO *COS COMPONENT.
!     *C___S*   REAL      *REFERS TO *SIN COMPONENT.
!     *CAEOP_*  REAL      *CONSTANTS USED FOR AEROSOL COMPUTATIONS.
!     *C___S*   REAL      *REFERS TO *SEA AEROSOLS.
!     *C___L*   REAL      *REFERS TO *LAND AEROSOLS.
!     *C___U*   REAL      *REFERS TO *URBAN AEROSOLS.
!     *C___D*   REAL      *REFERS TO *DESERT AEROSOLS.
!     *C__BGA*  REAL      *CONSTANTS USED FOR AEROSOL COMPUTATIONS.
!     *CVDAE_*  REAL      *CONSTANTS USED FOR AEROSOL COMPUTATIONS.(NFLEVG+1)
!     *RCTRPT*   REAL      *CONSTANTS USED FOR AEROSOL COMPUTATIONS.
!     *RCAEADK*  REAL      *CONSTANTS USED FOR AEROSOL COMPUTATIONS.
!     *RCAEADM*  REAL      *CONSTANTS USED FOR AEROSOL COMPUTATIONS.
!     *RCAEROS*  REAL      *BACKGROUND VALUE IN ABSENCE OF AEROSOLS.

!     ------------------------------------------------------------------

CONTAINS

SUBROUTINE PRINT_CONFIGURATION(SELF, KDEPTH, KOUTNO)
IMPLICIT NONE
CLASS(TEAERD), INTENT(IN) :: SELF
INTEGER      , INTENT(IN) :: KDEPTH
INTEGER      , INTENT(IN) :: KOUTNO

INTEGER :: IDEPTHLOC

IDEPTHLOC = KDEPTH+2

WRITE(KOUTNO,*) REPEAT(' ',KDEPTH   ) // 'model%yrml_phy_rad%yreaerd : '
IF (ALLOCATED(SELF%CVDAES)) WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'CVDAES ALLOCATED OF SHAPE ', &
 &        SHAPE(SELF%CVDAES), ' SUM ',SUM(SELF%CVDAES)
IF (ALLOCATED(SELF%CVDAEL)) WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'CVDAEL ALLOCATED OF SHAPE ', &
 &        SHAPE(SELF%CVDAEL), ' SUM ',SUM(SELF%CVDAEL)
IF (ALLOCATED(SELF%CVDAEU)) WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'CVDAEU ALLOCATED OF SHAPE ', &
 &        SHAPE(SELF%CVDAEU), ' SUM ',SUM(SELF%CVDAEU)
IF (ALLOCATED(SELF%CVDAED)) WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'CVDAED ALLOCATED OF SHAPE ', &
 &        SHAPE(SELF%CVDAED), ' SUM ',SUM(SELF%CVDAED)
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RAESC SUM = ', SUM(SELF%RAESC)
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RAESS SUM = ', SUM(SELF%RAESS)
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RAELC SUM = ', SUM(SELF%RAELC)
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RAELS SUM = ', SUM(SELF%RAELS)
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RAEUC SUM = ', SUM(SELF%RAEUC)
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RAEUS SUM = ', SUM(SELF%RAEUS)
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RAEDC SUM = ', SUM(SELF%RAEDC)
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RAEDS SUM = ', SUM(SELF%RAEDS)
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RCAEOPS = ', SELF%RCAEOPS
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RCAEOPL = ', SELF%RCAEOPL
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RCAEOPU = ', SELF%RCAEOPU
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RCAEOPD = ', SELF%RCAEOPD
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RCTRBGA = ', SELF%RCTRBGA
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RCVOBGA = ', SELF%RCVOBGA
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RCSTBGA = ', SELF%RCSTBGA
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RCTRPT = ', SELF%RCTRPT
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RCAEADK SUM = ', SUM(SELF%RCAEADK)
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RCAEADM = ', SELF%RCAEADM
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RCAEROS = ', SELF%RCAEROS

END SUBROUTINE PRINT_CONFIGURATION

END MODULE YOEAERD
