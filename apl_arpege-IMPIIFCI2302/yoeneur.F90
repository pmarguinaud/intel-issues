MODULE YOENEUR

USE PARKIND1  ,ONLY : JPIM     ,JPRB

IMPLICIT NONE

SAVE

TYPE :: TENEUR
INTEGER(KIND=JPIM) :: NCOU, NBR, NBNEURMAX
INTEGER(KIND=JPIM) :: KLEV_NN

INTEGER(KIND=JPIM), ALLOCATABLE :: NBNEUR(:,:)
REAL(KIND=JPRB),    ALLOCATABLE :: WNELN(:,:,:,:)
REAL(KIND=JPRB),    ALLOCATABLE :: ENTREEMOY(:,:), RAPIN(:,:)
REAL(KIND=JPRB),    ALLOCATABLE :: SORTIEMOY(:,:), RAPOUT(:,:)
REAL(KIND=JPRB),    ALLOCATABLE :: PDFSDX(:,:,:,:)
REAL(KIND=JPRB),    ALLOCATABLE :: AAM_NN(:), BBM_NN(:)
!----------------------------------------------------------------------------
CONTAINS
  PROCEDURE, PASS :: PRINT => PRINT_CONFIGURATION 
END TYPE TENEUR
!============================================================================

!!TYPE(TENEUR), POINTER :: YRENEUR => NULL()


CONTAINS

SUBROUTINE PRINT_CONFIGURATION(SELF, KDEPTH, KOUTNO)
IMPLICIT NONE
CLASS(TENEUR), INTENT(IN) :: SELF
INTEGER      , INTENT(IN) :: KDEPTH
INTEGER      , INTENT(IN) :: KOUTNO

INTEGER :: IDEPTHLOC

IDEPTHLOC = KDEPTH+2

WRITE(KOUTNO,*) REPEAT(' ',KDEPTH   ) // 'model%yrml_phy_rad%yreneur : '
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'NCOU = ', SELF%NCOU
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'NBR = ', SELF%NBR
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'NBNEURMAX = ', SELF%NBNEURMAX
WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'KLEV_NN = ', SELF%KLEV_NN
IF (ALLOCATED(SELF%NBNEUR)) WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'NBNEUR ALLOCATED OF SHAPE ', &
 &        SHAPE(SELF%NBNEUR), ' SUM ',SUM(SELF%NBNEUR)
IF (ALLOCATED(SELF%WNELN)) WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'WNELN ALLOCATED OF SHAPE ', &
 &        SHAPE(SELF%WNELN), ' SUM ',SUM(SELF%WNELN)
IF (ALLOCATED(SELF%ENTREEMOY)) WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'ENTREEMOY ALLOCATED OF SHAPE ', &
 &        SHAPE(SELF%ENTREEMOY), ' SUM ',SUM(SELF%ENTREEMOY)
IF (ALLOCATED(SELF%RAPIN)) WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RAPIN ALLOCATED OF SHAPE ', &
 &        SHAPE(SELF%RAPIN), ' SUM ',SUM(SELF%RAPIN)
IF (ALLOCATED(SELF%SORTIEMOY)) WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'SORTIEMOY ALLOCATED OF SHAPE ', &
 &        SHAPE(SELF%SORTIEMOY), ' SUM ',SUM(SELF%SORTIEMOY)
IF (ALLOCATED(SELF%RAPOUT)) WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'RAPOUT ALLOCATED OF SHAPE ', &
 &        SHAPE(SELF%RAPOUT), ' SUM ',SUM(SELF%RAPOUT)
IF (ALLOCATED(SELF%PDFSDX)) WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'PDFSDX ALLOCATED OF SHAPE ', &
 &        SHAPE(SELF%PDFSDX), ' SUM ',SUM(SELF%PDFSDX)
IF (ALLOCATED(SELF%AAM_NN)) WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'AAM_NN ALLOCATED OF SHAPE ', &
 &        SHAPE(SELF%AAM_NN), ' SUM ',SUM(SELF%AAM_NN)
IF (ALLOCATED(SELF%BBM_NN)) WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'BBM_NN ALLOCATED OF SHAPE ', &
 &        SHAPE(SELF%BBM_NN), ' SUM ',SUM(SELF%BBM_NN)

END SUBROUTINE PRINT_CONFIGURATION

END MODULE YOENEUR
